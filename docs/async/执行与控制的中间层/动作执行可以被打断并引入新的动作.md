因为可以中断动作，所以我们可以引入合并。

```
#!/usr/bin/env python3

"""

"""

import os
import sys
import time

sys.path.append(os.path.join(os.path.dirname(__file__), '../../..'))

from xarm.wrapper import XArmAPI

import argparse

def main(ip):
    parser = argparse.ArgumentParser()
    parser.add_argument("--pointnum", type=int, default=1, help="运动目标的个数, 为1代表只有终点和起点")
    parser.add_argument("--speed", type=int, default=100, help="速度")#注意，这个速度和角度的不一样，角度的0.6已经很快了
    parser.add_argument("--mode", type=int, default=0, help="0不会作出任何改变; 3导致暂停指令,但不会清空robot的执行队列; 4导致停止指令,并且会清空robot的执行队列")#注意，这个速度和角度的不一样，角度的0.6已经很快了
    parser.add_argument("--z", action="store_true", help="mode4时, 重新发送指令时, 往z轴添加扰动")

    args = parser.parse_args()
    pointnum = args.pointnum
    speed = args.speed
    mode = args.mode
    z_interval = 100
    z_inteference = args.z
    

    print(f"=========================================, pointnum is {pointnum}, speed is {speed}, mode is {mode}")


    arm = XArmAPI(ip)
    time.sleep(0.5)

    #clean error and warn
    if arm.warn_code != 0:
        arm.clean_warn()
    if arm.error_code != 0:
        arm.clean_error()

    arm.motion_enable(enable=True)
    arm.set_mode(0)
    arm.set_state(state=0)

    start_pose = [207.446075, 371.847595, 331.218597, -178.274959, 2.825656, -179.190316] # example

    # end_pose = [315.270996, 371.847595, 599.053223, -178.274959, 2.825656, -179.190316] # 599.053223
    end_pose = [243.410767, 549.297974, 332.45575, -178.274959, 2.825656, -179.190316] # 599.053223
    # end_pose = [243.410767, 549.297974, 332.45575, 173.127907, 9.727849, 177.763479]
    

    start = time.time()

    arm.set_position(x=end_pose[0], y=end_pose[1], z=end_pose[2], roll=start_pose[3], pitch=start_pose[4], yaw=start_pose[5], speed=speed, is_radian=False, wait=False)

    print("wowowowowowowowowwowowo")


    for point in range(1, pointnum+1):
        xyz = [0,0,0]
        for i in range(3):
            to = start_pose[i] + (end_pose[i] - start_pose[i])/pointnum * point
            xyz[i] = to
        
        while True:
            now_position = arm.get_position(is_radian=False)
            now_x = now_position[1][0]#now_position[0] is the code
            # print(now_x)
            if now_x+0.001 >= xyz[0]:
                break
            # time.sleep(0.05)
        if point != pointnum:# corner case，最后一步不要停
            print("停顿一次")
            arm.set_state(mode)
            time.sleep(0.01)
            arm.set_state(0)
            if mode == 4:# 需要重新加入指令
                z_position=end_pose[2]
                if z_inteference:
                    z_position += z_interval/pointnum*point
                arm.set_position(x=end_pose[0], y=end_pose[1], z=z_position, roll=start_pose[3], pitch=start_pose[4], yaw=start_pose[5], speed=speed, is_radian=False, wait=False)
        # interpolate_pose = ...
        # execute_start = time.time()
        # arm.set_position(x=xyz[0], y=xyz[1], z=xyz[2], roll=start_pose[3], pitch=start_pose[4], yaw=start_pose[5], speed=speed, is_radian=False, wait=True)
        # execute_end = time.time()
        # print(f"execute time is {(execute_end - execute_start):.2f}")

    # for point in range(1, pointnum+1):
    #     xyz = [0,0,0]
    #     for i in range(3):
    #         to = start_pose[i] + (end_pose[i] - start_pose[i])/pointnum * point
    #         xyz[i] = to
    #     # interpolate_pose = ...
    #     execute_start = time.time()
    #     # arm.set_position(x=xyz[0], y=xyz[1], z=xyz[2], roll=start_pose[3], pitch=start_pose[4], yaw=start_pose[5], speed=speed, is_radian=False, wait=True)
    #     execute_end = time.time()
    #     print(f"execute time is {(execute_end - execute_start):.2f}")
        

    end = time.time()

    print(f"total time is {(end - start):.2f}\n\n")


    # arm.set_position(x=pose[0], y=pose[1], z=pose[2], roll=pose[3], pitch=pose[4], yaw=pose[5], speed=1, is_radian=False, wait=True)

    # print(arm.get_position(is_radian=False))

    time.sleep(3)
    arm.set_position(x=start_pose[0], y=start_pose[1], z=start_pose[2], roll=start_pose[3], pitch=start_pose[4], yaw=start_pose[5], speed=speed, is_radian=False, wait=True)


if __name__ == '__main__':
    ip = '192.168.1.239'
    main(ip)
```